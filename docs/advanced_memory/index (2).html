<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Report: The Advanced AI Agent Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Soothing & Professional -->
    <!-- Application Structure Plan: A tab-based navigation SPA is chosen over a linear report to improve usability. The dense, technical content from the source report is broken down into logical, thematic sections: 'Overview' (high-level concept), 'Architecture' (visualizing the system), 'Implementation' (comparing code paths), and 'Advanced' (expert topics). This structure guides users from foundational knowledge to practical details, allowing them to explore topics of interest non-linearly, which is more effective for learning and reference than a simple scroll-through document. The new architectural elements (Verification and Orchestration Layers) are integrated directly into the interactive diagram and the Advanced section. -->
    <!-- Visualization & Content Choices: 
        - Report Info: System architecture flow -> Goal: Organize/Explain Process -> Viz: Interactive HTML/CSS/JS diagram. Interaction: Clicking a component highlights the data flow and displays contextual info. Justification: A static diagram is less engaging; this interaction actively involves the user in understanding the complex process, including the new Verification and Orchestration layers. Library/Method: Vanilla JS and Tailwind CSS.
        - Report Info: GraphRAG Implementation Paths (Microsoft, Neo4j, LlamaIndex) -> Goal: Compare -> Viz: Tabbed interface with side-by-side code blocks. Interaction: User clicks tabs to switch between implementations. Justification: Direct comparison is crucial for this technical decision. Tabs provide the clearest, most direct way to compare distinct, complex code-based options. Library/Method: Vanilla JS.
        - Report Info: Comparison of GraphRAG engines -> Goal: Compare -> Viz: Bar Chart. Interaction: Tooltips on hover. Justification: A chart visually summarizes qualitative trade-offs (ease of use, control) more effectively than a simple table. Library/Method: Chart.js.
        - Report Info: Advanced Strategies (Orchestration, Feedback, Verification) -> Goal: Inform/Organize -> Viz: Accordion list. Interaction: Clicking a title expands to reveal details. Justification: Hides complex information by default, reducing cognitive load and allowing users to focus on specific advanced topics as needed. Library/Method: Vanilla JS.
        - Gemini API Integration: Query Suggestion -> Goal: Illustrate/Engage -> Viz: Button-triggered text generation. Interaction: User clicks a button to get AI-generated example queries. Justification: Makes the abstract architecture more concrete by showing what kind of questions it can handle. Library/Method: Gemini API.
        - Gemini API Integration: Strategy Explainer -> Goal: Simplify/Inform -> Viz: Button-triggered text generation. Interaction: User clicks a button for an ELI5 explanation of a complex topic. Justification: Increases accessibility for non-expert audiences. Library/Method: Gemini API.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }

        .nav-active {
            color: #0284c7;
            border-bottom-color: #0284c7;
        }

        .nav-inactive {
            color: #475569;
            border-bottom-color: transparent;
        }

        .tab-active {
            border-color: #0ea5e9;
            color: #0ea5e9;
            font-weight: 600;
        }

        .tab-inactive {
            border-color: transparent;
            color: #64748b;
        }

        .impl-content {
            display: none;
        }

        .content-active {
            display: block;
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .flow-box {
            transition: all 0.2s ease-in-out;
        }

        .flow-box-active {
            box-shadow: 0 0 0 3px #38bdf8, 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            transform: scale(1.05);
            border-color: #38bdf8;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 50vh;
        }

        .loader {
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #38bdf8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800">

    <div class="min-h-screen">
        <header class="sticky top-0 bg-white/80 backdrop-blur-lg z-50 border-b border-slate-200">
            <nav class="container mx-auto px-4">
                <ul class="flex items-center justify-center h-16 text-sm font-medium">
                    <li class="mr-6"><a href="#overview" class="nav-link border-b-2 nav-active">Overview</a></li>
                    <li class="mr-6"><a href="#architecture" class="nav-link border-b-2 nav-inactive">Architecture</a>
                    </li>
                    <li class="mr-6"><a href="#implementation"
                            class="nav-link border-b-2 nav-inactive">Implementation</a></li>
                    <li><a href="#advanced" class="nav-link border-b-2 nav-inactive">Advanced Concepts</a></li>
                </ul>
            </nav>
        </header>

        <main class="container mx-auto p-4 md:p-8">

            <!-- Overview Section -->
            <section id="overview" class="pt-16 -mt-16 min-h-screen flex items-center">
                <div class="w-full">
                    <div class="text-center">
                        <h1 class="text-4xl md:text-6xl font-bold text-slate-900">The Modern AI Agent</h1>
                        <p class="text-lg md:text-xl text-slate-600 mt-4 max-w-4xl mx-auto">An interactive guide to a
                            cognitive architecture combining deep knowledge, personal memory, verification, and
                            orchestration.</p>
                    </div>

                    <div class="mt-12 p-6 md:p-8 rounded-xl bg-white shadow-lg">
                        <h2 class="text-2xl font-bold text-slate-900 mb-4 text-center">The "Two Brains" Analogy + Safety
                            Layers</h2>
                        <p class="text-slate-600 mb-8 text-center max-w-3xl mx-auto">Standard AI agents are often
                            stateless and prone to errors. This architecture solves these issues by creating a more
                            robust "mind" with distinct components for knowledge, memory, and reasoning, leading to a
                            more capable and trustworthy AI partner.</p>

                        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 items-stretch">
                            <div
                                class="p-6 border border-slate-200 rounded-lg bg-slate-50 text-center flex flex-col justify-center transform hover:scale-105 transition-transform">
                                <h3 class="font-bold text-sky-700 text-xl mb-2">Knowledge Brain</h3>
                                <div class="text-5xl mb-4">üß†</div>
                                <h4 class="font-semibold text-slate-800 mb-2">GraphRAG</h4>
                                <p class="text-sm text-slate-500">The agent's deep library of domain expertise. It
                                    answers: "What is known about subject X?"</p>
                            </div>
                            <div
                                class="p-6 border border-slate-200 rounded-lg bg-slate-50 text-center flex flex-col justify-center transform hover:scale-105 transition-transform">
                                <h3 class="font-bold text-sky-700 text-xl mb-2">Memory Brain</h3>
                                <div class="text-5xl mb-4">üí¨</div>
                                <h4 class="font-semibold text-slate-800 mb-2">Mem0</h4>
                                <p class="text-sm text-slate-500">The agent's evolving, personal memory of interactions.
                                    It answers: "What do I know about this user?"</p>
                            </div>
                            <div
                                class="p-6 border border-slate-200 rounded-lg bg-slate-50 text-center flex flex-col justify-center transform hover:scale-105 transition-transform">
                                <h3 class="font-bold text-sky-700 text-xl mb-2">Verification Layer</h3>
                                <div class="text-5xl mb-4">üõ°Ô∏è</div>
                                <h4 class="font-semibold text-slate-800 mb-2">Grounding RAG</h4>
                                <p class="text-sm text-slate-500">A fact-checker to ensure accuracy and reduce
                                    hallucination. It asks: "Is this generated fact true and current?"</p>
                            </div>
                            <div
                                class="p-6 border border-slate-200 rounded-lg bg-slate-50 text-center flex flex-col justify-center transform hover:scale-105 transition-transform">
                                <h3 class="font-bold text-sky-700 text-xl mb-2">Orchestration Layer</h3>
                                <div class="text-5xl mb-4">‚öôÔ∏è</div>
                                <h4 class="font-semibold text-slate-800 mb-2">Sequential-Thinking MCP</h4>
                                <p class="text-sm text-slate-500">The conductor that manages complex workflows for
                                    efficiency and reliability. It decides: "What is the best sequence of actions?"</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Architecture Section -->
            <section id="architecture" class="pt-24 -mt-16">
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-bold text-slate-900 mb-4 text-center">Interactive System Architecture</h2>
                    <p class="text-slate-600 mb-8 text-center max-w-3xl mx-auto">This diagram visualizes the data flow
                        from user query to final response. The agent leverages the MCP Server, which acts as an
                        Orchestrator to intelligently call the various knowledge, memory, and verification providers.
                        Click each component to learn about its role in the process.</p>

                    <div id="flow-diagram"
                        class="relative flex flex-col md:flex-row justify-around items-center space-y-8 md:space-y-0 md:space-x-4 p-4">
                        <div data-component="user"
                            class="flow-box text-center p-4 border rounded-lg cursor-pointer transition-all w-48 bg-white shadow-sm">
                            <span class="text-4xl">üë§</span>
                            <p class="font-semibold mt-2">User</p>
                        </div>
                        <div data-component="agent"
                            class="flow-box text-center p-4 border rounded-lg cursor-pointer transition-all w-48 bg-white shadow-sm">
                            <span class="text-4xl">ü§ñ</span>
                            <p class="font-semibold mt-2">AI Agent</p>
                        </div>
                        <div data-component="mcp"
                            class="flow-box text-center p-4 border rounded-lg cursor-pointer transition-all w-48 bg-white shadow-sm">
                            <span class="text-4xl">‚öôÔ∏è</span>
                            <p class="font-semibold mt-2">MCP Orchestrator</p>
                        </div>
                        <div class="flex flex-col space-y-4">
                            <div data-component="graphrag"
                                class="flow-box text-center p-4 border rounded-lg cursor-pointer transition-all w-48 bg-white shadow-sm">
                                <span class="text-4xl">üß†</span>
                                <p class="font-semibold mt-2">Knowledge Provider</p>
                            </div>
                            <div data-component="mem0"
                                class="flow-box text-center p-4 border rounded-lg cursor-pointer transition-all w-48 bg-white shadow-sm">
                                <span class="text-4xl">üí¨</span>
                                <p class="font-semibold mt-2">Memory Provider</p>
                            </div>
                            <div data-component="grounding"
                                class="flow-box text-center p-4 border rounded-lg cursor-pointer transition-all w-48 bg-white shadow-sm">
                                <span class="text-4xl">üõ°Ô∏è</span>
                                <p class="font-semibold mt-2">Verification Provider</p>
                            </div>
                        </div>
                    </div>

                    <div id="component-info"
                        class="mt-8 p-6 bg-sky-50 border border-sky-200 rounded-lg text-center min-h-[120px] flex items-center justify-center transition-all">
                        <p class="text-slate-700">Click a component above to see its description.</p>
                    </div>

                    <div class="mt-8 text-center">
                        <button id="suggest-queries-btn"
                            class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">‚ú®
                            Suggest Example Queries</button>
                        <div id="query-suggestions" class="mt-4 text-left p-4 bg-slate-100 rounded-lg hidden"></div>
                    </div>
                </div>
            </section>

            <!-- Implementation Section -->
            <section id="implementation" class="pt-24 -mt-16">
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-bold text-slate-900 mb-4 text-center">Implementation Hub</h2>
                    <p class="text-slate-600 mb-12 text-center max-w-3xl mx-auto">Building the GraphRAG knowledge core
                        is a critical step. The best engine depends on your project's needs for control, ease of use,
                        and existing infrastructure. The chart below visualizes these key trade-offs, and the tabs let
                        you compare conceptual code for each path.</p>

                    <div class="chart-container mb-12">
                        <canvas id="engine-comparison-chart"></canvas>
                    </div>

                    <div class="mb-4 border-b border-gray-200">
                        <ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="impl-tabs">
                            <li class="mr-2"><a href="#" class="inline-block p-4 border-b-2 rounded-t-lg tab-active"
                                    data-impl-tab="msft">Microsoft `graphrag`</a></li>
                            <li class="mr-2"><a href="#" class="inline-block p-4 border-b-2 rounded-t-lg tab-inactive"
                                    data-impl-tab="neo4j">`neo4j-graphrag`</a></li>
                            <li class="mr-2"><a href="#" class="inline-block p-4 border-b-2 rounded-t-lg tab-inactive"
                                    data-impl-tab="llama">LlamaIndex</a></li>
                        </ul>
                    </div>

                    <div>
                        <div id="msft" class="impl-content content-active">
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="p-6 bg-slate-100 rounded-lg">
                                    <h4 class="font-semibold text-lg mb-2">Microsoft `graphrag`</h4>
                                    <p class="text-slate-600 mb-4 text-sm">The reference implementation. It's powerful
                                        and highly configurable via YAML files, but programmatic integration often
                                        requires wrapping command-line tools. This gives you maximum fidelity to the
                                        original research.</p>
                                    <p class="font-semibold text-sm mb-1">Best for:</p>
                                    <ul class="list-disc list-inside text-slate-600 text-sm space-y-1">
                                        <li>Reproducing original research papers</li>
                                        <li>Deep, fine-grained pipeline customization</li>
                                        <li>Projects comfortable with config-driven workflows</li>
                                    </ul>
                                </div>
                                <pre class="bg-slate-800 text-white p-4 rounded-lg text-xs overflow-x-auto"><code><span class="text-slate-400">// Indexing (CLI-based)</span>
<span class="text-purple-400">python</span> -m graphrag.index <span class="text-green-400">--root</span> ./project

<span class="text-slate-400">// Querying (via Subprocess Wrapper)</span>
<span class="text-purple-400">import</span> subprocess

<span class="text-yellow-400">def</span> <span class="text-blue-400">query_microsoft_graphrag</span>(query):
    cmd = [<span class="text-orange-400">"python"</span>, <span class="text-orange-400">"-m"</span>, <span class="text-orange-400">"graphrag.query"</span>, query]
    result = subprocess.run(cmd, capture_output=<span class="text-red-400">True</span>)
    <span class="text-purple-400">return</span> result.stdout</code></pre>
                            </div>
                        </div>
                        <div id="neo4j" class="impl-content">
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="p-6 bg-slate-100 rounded-lg">
                                    <h4 class="font-semibold text-lg mb-2">`neo4j-graphrag`</h4>
                                    <p class="text-slate-600 mb-4 text-sm">An official, SDK-first library from Neo4j for
                                        using GraphRAG with a native graph database backend. It offers excellent,
                                        production-ready programmatic control.</p>
                                    <p class="font-semibold text-sm mb-1">Best for:</p>
                                    <ul class="list-disc list-inside text-slate-600 text-sm space-y-1">
                                        <li>Production systems with a graph DB</li>
                                        <li>Complex Cypher-based graph traversals</li>
                                        <li>Clean, SDK-based integration</li>
                                    </ul>
                                </div>
                                <pre class="bg-slate-800 text-white p-4 rounded-lg text-xs overflow-x-auto"><code><span class="text-slate-400">// Indexing (Python SDK)</span>
<span class="text-purple-400">from</span> neo4j_graphrag.pipeline <span class="text-purple-400">import</span> SimpleKGPipeline
pipeline = SimpleKGPipeline(llm, embedder)
pipeline.run(docs, driver=neo4j_driver)

<span class="text-slate-400">// Querying (Python SDK)</span>
<span class="text-purple-400">from</span> neo4j_graphrag.generation <span class="text-purple-400">import</span> GraphRAG
rag = GraphRAG(retriever, llm)
response = rag.search(query)</code></pre>
                            </div>
                        </div>
                        <div id="llama" class="impl-content">
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="p-6 bg-slate-100 rounded-lg">
                                    <h4 class="font-semibold text-lg mb-2">LlamaIndex Integration</h4>
                                    <p class="text-slate-600 mb-4 text-sm">Integrates GraphRAG concepts into its
                                        high-level, modular framework. Involves building custom components for a
                                        flexible pipeline, ideal for rapid development and experimentation.</p>
                                    <p class="font-semibold text-sm mb-1">Best for:</p>
                                    <ul class="list-disc list-inside text-slate-600 text-sm space-y-1">
                                        <li>Rapid prototyping and experimentation</li>
                                        <li>Integration into existing LlamaIndex apps</li>
                                        <li>Abstracting away low-level details</li>
                                    </ul>
                                </div>
                                <pre class="bg-slate-800 text-white p-4 rounded-lg text-xs overflow-x-auto"><code><span class="text-slate-400">// Indexing & Querying (Unified)</span>
<span class="text-purple-400">from</span> llama_index.core <span class="text-purple-400">import</span> PropertyGraphIndex

<span class="text-slate-400">// Define extractors and custom components</span>
graph_store = GraphRAGStore()
index = PropertyGraphIndex.from_documents(
    docs,
    kg_extractors=[custom_extractor],
    property_graph_store=graph_store
)
query_engine = index.as_query_engine()
response = query_engine.query(query)</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Advanced Section -->
            <section id="advanced" class="pt-24 -mt-16">
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-3xl font-bold text-slate-900 mb-4 text-center">Advanced Concepts & Best Practices
                    </h2>
                    <p class="text-slate-600 mb-8 text-center max-w-3xl mx-auto">Moving from a functional prototype to a
                        robust production system requires a focus on orchestration, verification, optimization, and
                        creating intelligent feedback loops. Explore these advanced topics below.</p>

                    <div id="accordion" class="space-y-4 max-w-4xl mx-auto">
                        <div class="border border-slate-200 rounded-lg">
                            <button
                                class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left">
                                <span>The Orchestration Layer (Sequential-Thinking MCP)</span>
                                <span class="accordion-icon transition-transform transform text-xl font-light">+</span>
                            </button>
                            <div class="accordion-content px-5 pb-5">
                                <p class="text-slate-600 text-sm">Instead of the agent making multiple, separate tool
                                    calls, it can make a single call to a high-level tool like `get_verified_answer()`.
                                    The MCP server then acts as an orchestrator, executing the complex, multi-step
                                    workflow internally (e.g., search memory, query knowledge, verify result). This
                                    simplifies agent logic, improves performance by allowing parallel calls, and
                                    centralizes complex business logic on the server.</p>
                                <div class="mt-4">
                                    <button data-strategy="orchestration"
                                        class="gemini-explain-btn bg-indigo-100 text-indigo-700 text-sm font-semibold py-1 px-3 rounded-full hover:bg-indigo-200 transition-colors">‚ú®
                                        Explain This Simply</button>
                                    <div data-strategy-output="orchestration"
                                        class="strategy-output mt-3 text-sm p-3 bg-indigo-50 rounded-md border border-indigo-200 hidden">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border border-slate-200 rounded-lg">
                            <button
                                class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left">
                                <span>The Verification Layer (Grounding RAG)</span>
                                <span class="accordion-icon transition-transform transform text-xl font-light">+</span>
                            </button>
                            <div class="accordion-content px-5 pb-5">
                                <p class="text-slate-600 text-sm">This is a second, lightweight RAG system that acts as
                                    a fast fact-checker. It's pointed at a corpus of highly trusted, time-sensitive
                                    documents. Before providing an answer, the Orchestration Layer can use this tool to
                                    verify factual claims (dates, numbers, names) generated by the main knowledge query.
                                    This drastically reduces hallucinations and increases user trust by ensuring
                                    information is both accurate and current.</p>
                                <div class="mt-4">
                                    <button data-strategy="verification"
                                        class="gemini-explain-btn bg-indigo-100 text-indigo-700 text-sm font-semibold py-1 px-3 rounded-full hover:bg-indigo-200 transition-colors">‚ú®
                                        Explain This Simply</button>
                                    <div data-strategy-output="verification"
                                        class="strategy-output mt-3 text-sm p-3 bg-indigo-50 rounded-md border border-indigo-200 hidden">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border border-slate-200 rounded-lg">
                            <button
                                class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left">
                                <span>Creating an Intelligent Feedback Loop</span>
                                <span class="accordion-icon transition-transform transform text-xl font-light">+</span>
                            </button>
                            <div class="accordion-content px-5 pb-5">
                                <p class="text-slate-600 text-sm"><span class="font-semibold">From Knowledge to
                                        Memory:</span> When the agent successfully uses knowledge to help a user, the
                                    entire interaction is saved to Mem0. This helps the agent "remember" what it taught
                                    the user.<br><br><span class="font-semibold">From Memory to Knowledge:</span> By
                                    analyzing (anonymized) user queries from memory logs, administrators can identify
                                    gaps in the knowledge base. If many users ask about a topic the system knows nothing
                                    about, it's a clear signal to add new documents to the GraphRAG corpus, creating a
                                    self-improving system.</p>
                                <div class="mt-4">
                                    <button data-strategy="feedback"
                                        class="gemini-explain-btn bg-indigo-100 text-indigo-700 text-sm font-semibold py-1 px-3 rounded-full hover:bg-indigo-200 transition-colors">‚ú®
                                        Explain This Simply</button>
                                    <div data-strategy-output="feedback"
                                        class="strategy-output mt-3 text-sm p-3 bg-indigo-50 rounded-md border border-indigo-200 hidden">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border border-slate-200 rounded-lg">
                            <button
                                class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left">
                                <span>Performance and Scalability</span>
                                <span class="accordion-icon transition-transform transform text-xl font-light">+</span>
                            </button>
                            <div class="accordion-content px-5 pb-5">
                                <ul class="list-disc list-inside text-slate-600 text-sm space-y-2">
                                    <li><span class="font-semibold">Caching:</span> Cache responses to common queries to
                                        reduce redundant LLM calls and database lookups.</li>
                                    <li><span class="font-semibold">Vector DB Tuning:</span> Experiment with embedding
                                        models and tune the number of retrieved documents (`top_k`) to balance speed and
                                        recall.</li>
                                    <li><span class="font-semibold">Prompt Formatting:</span> Use clear delimiters in
                                        the final prompt to separate system instructions, retrieved knowledge, and
                                        memory context.</li>
                                    <li><span class="font-semibold">Stateless Server:</span> The FastAPI-based MCP
                                        server is stateless and can be horizontally scaled. All state is managed in the
                                        backend databases (Neo4j, Qdrant), which is a robust pattern for cloud
                                        deployment.</li>
                                </ul>
                                <div class="mt-4">
                                    <button data-strategy="performance"
                                        class="gemini-explain-btn bg-indigo-100 text-indigo-700 text-sm font-semibold py-1 px-3 rounded-full hover:bg-indigo-200 transition-colors">‚ú®
                                        Explain This Simply</button>
                                    <div data-strategy-output="performance"
                                        class="strategy-output mt-3 text-sm p-3 bg-indigo-50 rounded-md border border-indigo-200 hidden">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Main navigation scroll behavior
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.remove('nav-active');
                            link.classList.add('nav-inactive');
                            if (link.getAttribute('href').substring(1) === entry.target.id) {
                                link.classList.add('nav-active');
                                link.classList.remove('nav-inactive');
                            }
                        });
                    }
                });
            }, { rootMargin: "-50% 0px -50% 0px" });

            sections.forEach(section => {
                observer.observe(section);
            });

            // Implementation Hub tabs
            const implTabs = document.querySelectorAll('#impl-tabs a');
            const implContents = document.querySelectorAll('.impl-content');

            function switchImplTab(clickedTab) {
                implTabs.forEach(t => {
                    t.classList.remove('tab-active');
                    t.classList.add('tab-inactive');
                });
                clickedTab.classList.add('tab-active');
                clickedTab.classList.remove('tab-inactive');

                implContents.forEach(c => {
                    c.classList.remove('content-active');
                    if (c.id === clickedTab.dataset.implTab) {
                        c.classList.add('content-active');
                    }
                });
            }

            implTabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    e.preventDefault();
                    switchImplTab(tab);
                });
            });

            // Architecture diagram interaction
            const flowBoxes = document.querySelectorAll('.flow-box');
            const componentInfo = document.getElementById('component-info');
            const componentDescriptions = {
                user: "Initiates the interaction with a prompt or query.",
                agent: "The core AI. It receives the user's prompt and makes a single, high-level tool call to the MCP Orchestrator to get a comprehensive, verified answer.",
                mcp: "The Orchestration Layer. It receives the agent's high-level request and executes a pre-defined sequence of calls to the various backend providers to fulfill it.",
                graphrag: "The Knowledge Provider. It's called by the orchestrator to query the deep, structured domain knowledge from the knowledge graph.",
                mem0: "The Memory Provider. It's called by the orchestrator to search for relevant past interactions and user preferences.",
                grounding: "The Verification Provider. It's called by the orchestrator to fact-check claims against a trusted, up-to-date corpus before finalizing the answer."
            };

            flowBoxes.forEach(box => {
                box.addEventListener('click', () => {
                    const component = box.dataset.component;
                    componentInfo.innerHTML = `<p class="text-slate-800 font-semibold text-lg">${box.textContent.trim()}</p><p class="text-slate-600 mt-1">${componentDescriptions[component]}</p>`;
                    flowBoxes.forEach(b => b.classList.remove('flow-box-active'));
                    box.classList.add('flow-box-active');
                });
            });

            // Accordion interaction
            const accordions = document.querySelectorAll('.accordion-toggle');
            accordions.forEach(accordion => {
                accordion.addEventListener('click', () => {
                    const content = accordion.nextElementSibling;
                    const icon = accordion.querySelector('.accordion-icon');
                    const isOpen = content.style.maxHeight && content.style.maxHeight !== '0px';

                    if (isOpen) {
                        content.style.maxHeight = '0px';
                        icon.style.transform = 'rotate(0deg)';
                        icon.textContent = '+';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.style.transform = 'rotate(45deg)';
                        icon.textContent = '√ó';
                    }
                });
            });

            // Gemini API Integration
            const suggestQueriesBtn = document.getElementById('suggest-queries-btn');
            const querySuggestionsContainer = document.getElementById('query-suggestions');
            const explainBtns = document.querySelectorAll('.gemini-explain-btn');

            const strategyPrompts = {
                orchestration: "Explain the 'Orchestration Layer' for an AI agent like I'm 5. The agent has different tools like knowledge, memory, and a fact-checker. How does the orchestrator help it use them correctly?",
                verification: "Explain the 'Verification Layer' or 'Grounding RAG' for an AI agent like I'm 5. Why is it important for the AI to have a separate fact-checker?",
                feedback: "Explain the concept of a 'Feedback Loop' between an AI's knowledge and memory like I'm 5. How does the AI get smarter by remembering what it told me and noticing what it doesn't know?",
                performance: "Explain 'Performance and Scalability' for an AI agent like I'm 5. What are three simple things, like caching or tuning, that make the AI faster and able to handle more users?"
            };

            async function callGemini(prompt) {
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                const payload = { contents: [{ parts: [{ text: prompt }] }] };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error(`API call failed with status: ${response.status}`);
                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 && result.candidates[0].content.parts[0].text) {
                        return result.candidates[0].content.parts[0].text;
                    }
                    return "Sorry, I couldn't generate a response. Please try again.";
                } catch (error) {
                    console.error("Gemini API call error:", error);
                    return "An error occurred while contacting the AI. Please check the console for details.";
                }
            }

            suggestQueriesBtn.addEventListener('click', async () => {
                querySuggestionsContainer.innerHTML = '<div class="loader"></div>';
                querySuggestionsContainer.classList.remove('hidden');

                const prompt = "You are an AI assistant. Generate three distinct example user queries for an advanced AI agent that has knowledge, memory, and verification layers. Create one query that clearly needs the knowledge brain, one that clearly needs the memory brain, and one that needs the full orchestration (memory, knowledge, and verification). Present them as a numbered list with a brief explanation for each.";
                const suggestions = await callGemini(prompt);

                querySuggestionsContainer.innerHTML = suggestions.replace(/\n/g, '<br>');
            });

            explainBtns.forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const strategy = e.target.dataset.strategy;
                    const outputDiv = document.querySelector(`div[data-strategy-output="${strategy}"]`);
                    const accordionContent = btn.closest('.accordion-content');

                    outputDiv.innerHTML = '<div class="loader"></div>';
                    outputDiv.classList.remove('hidden');
                    accordionContent.style.maxHeight = accordionContent.scrollHeight + outputDiv.scrollHeight + 'px';

                    const prompt = strategyPrompts[strategy];
                    const explanation = await callGemini(prompt);

                    outputDiv.innerHTML = explanation.replace(/\n/g, '<br>');
                    accordionContent.style.maxHeight = accordionContent.scrollHeight + 'px';
                });
            });

            // Chart.js implementation
            const ctx = document.getElementById('engine-comparison-chart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Microsoft `graphrag`', '`neo4j-graphrag`', 'LlamaIndex'],
                    datasets: [{
                        label: 'Ease of Programmatic Integration',
                        data: [6, 9, 10],
                        backgroundColor: 'rgba(56, 189, 248, 0.6)',
                        borderColor: 'rgba(14, 165, 233, 1)',
                        borderWidth: 1,
                        borderRadius: 4,
                    }, {
                        label: 'Level of Control/Customization',
                        data: [10, 9, 8],
                        backgroundColor: 'rgba(129, 140, 248, 0.6)',
                        borderColor: 'rgba(109, 40, 217, 1)',
                        borderWidth: 1,
                        borderRadius: 4,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10,
                            title: { display: true, text: 'Relative Score (1-10)', color: '#475569' },
                            grid: { color: '#e2e8f0' },
                            ticks: { color: '#475569' }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#475569' }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'GraphRAG Engine Implementation Trade-offs',
                            font: { size: 16 },
                            color: '#1e293b',
                            padding: { bottom: 20 }
                        },
                        tooltip: {
                            backgroundColor: '#1e293b',
                            titleColor: '#f8fafc',
                            bodyColor: '#f8fafc',
                            padding: 10,
                            cornerRadius: 4,
                            boxPadding: 4,
                            callbacks: {
                                title: function (tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    if (Array.isArray(label)) {
                                        return label.join(' ');
                                    }
                                    return label;
                                }
                            }
                        },
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#334155'
                            }
                        }
                    }
                }
            });
        });
    </script>
</body>

</html>