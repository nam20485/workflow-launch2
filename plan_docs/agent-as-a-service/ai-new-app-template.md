# **New Application**

## **App Title**

Agent as a Service (AaaS)

## **Development Plan**

This plan outlines the creation of a scalable, multi-tenant, cloud-native platform for building, deploying, and managing advanced AI agents. The system will be built using a **microservices architecture** to ensure high availability, independent scalability of components, and streamlined continuous integration/continuous deployment (CI/CD) cycles. The entire development and deployment lifecycle will be orchestrated using **.NET Aspire**, which will serve as the foundational framework for local development, service discovery, and operational observability.

.NET Aspire will provide a cohesive development experience by managing service discovery, resilience policies, and configuration through a declarative AppHost project. Its integrated dashboard will offer a unified view of logs, traces, and metrics from all services, which is indispensable for debugging and monitoring a distributed system.

The core of the platform is a central **Orchestration Service**. This service functions as an advanced implementation of the Model Context Protocol (MCP) server concept, acting as the primary entry point for agent interactions. It will manage the complex agentic workflow by making calls to other specialized, independent microservices:

1. **Knowledge Service:** Implements the **GraphRAG** methodology using the neo4j-graphrag library, backed by a dedicated Neo4j database instance. This service is responsible for the asynchronous, resource-intensive process of ingesting and indexing user-provided documents into a rich knowledge graph. It will expose secure endpoints for initiating indexing jobs and performing global (thematic) and local (entity-specific) knowledge queries.  
2. **Memory Service:** Implements the **Mem0** memory layer, utilizing its Python SDK with a hybrid backend of a Qdrant vector store for semantic search and a Neo4j graph store for relational memory. This service provides agents with stateful, personalized long-term memory, ensuring that all data is strictly partitioned by tenant ID to maintain data isolation and privacy.  
3. **Verification Service:** Implements the **Grounding RAG** pattern as a distinct microservice. This is a lightweight, high-speed RAG service pointed at a corpus of highly trusted, frequently updated data. Its sole purpose is to fact-check specific claims (e.g., dates, statistics, proper nouns) generated by an agent before the response is sent to the user, thereby increasing trust and reliability.  
4. **Tooling Service:** Provides a secure, sandboxed environment for executing agent-defined "tools" or "functions." This service will manage a library of predefined, safe, platform-provided tools (e.g., calculator, web search) and offer a framework for users to securely register their own custom tools, such as those that call internal company APIs.

A **Blazor WebAssembly** application will serve as the platform's primary user interface. This rich single-page application (SPA) will provide a comprehensive management portal for users to configure their agents, manage knowledge bases, define custom tools, and monitor agent activity and resource consumption in real-time.

## **Description**

### **Overview**

This application is an "Agent as a Service" (AaaS) platform, a comprehensive, enterprise-grade solution that abstracts away the immense complexity of building, hosting, and managing sophisticated AI agents. Its key architectural differentiator is the implementation of a **"graph-of-graphs"** architecture. In this model, the platform maintains a large-scale knowledge graph (via the Knowledge Service) that represents the objective, factual "collective unconscious" of a given domain. Concurrently, it dynamically builds a unique, isolated memory graph for each user's agent (via the Memory Service), representing the agent's subjective "personal consciousness" and interaction history. The platform's true innovation lies in enabling agents to reason and traverse across these two graph structures, allowing for an unprecedented level of contextual understanding and personalization. For example, an agent can leverage the shared knowledge graph to understand a complex financial term, and then consult its personal memory graph to recall the user's specific investment goals and risk tolerance.

The system is designed around **advanced orchestration patterns**, where the core Orchestration Service acts as a "meta-agent" or conductor. It offloads complex, multi-step workflows (e.g., concurrently searching memory and querying knowledge, then synthesizing a preliminary answer, then sending that answer to the Verification Service, and finally generating a refined response) from the agent itself. This makes the agents built on the platform far more robust, reliable, and performant, as the orchestration logic is centralized, optimized, and maintained by the platform.

### **Document Links**

* [index](./index.html)
* [infographic](./infographic.html)

### **Requirements**

#### **Features**

* \[x\] **Test cases:** A comprehensive suite of unit, integration, and end-to-end tests.  
* \[x\] **Logging:** Structured logging implemented across all services, correlated with request traces.  
* \[x\] **Containerization: Docker:** All microservices and backing stores will be fully containerized.  
* \[x\] **Containerization: Docker Compose:** A docker-compose.yml file will be provided for production-like environments.  
* \[x\] **Swagger/OpenAPI:** Each microservice will expose an OpenAPI specification for its API.  
* \[x\] **Documentation:** Detailed developer and user documentation.  
* \[x\] **Easy initialization/configuration startup apps (managed by .NET Aspire):** The AppHost project will enable a one-click launch of the entire distributed system for local development.  
* **Multi-Tenancy:** Secure data isolation will be enforced at the API gateway, service, and database levels, ensuring one tenant's data is never exposed to another.  
* **Knowledge Base Management:** The UI will support uploading various document formats (.txt, .pdf, .md) and will provide a dashboard to monitor the status of indexing jobs, view the number of indexed documents, and trigger re-indexing.  
* **Tool Definition Interface:** A secure UI where users can register custom tools by providing an OpenAPI specification for their API endpoint. The platform will validate the spec and provide a secure mechanism for storing credentials using a managed vault.  
* **Agent Monitoring Dashboard:** This will be a real-time dashboard in the Blazor app showing per-agent metrics like API call count, average response time, token usage, and costs, allowing users to track performance and spending.

#### **Acceptance Criteria**

* Given a new user has registered, when they create a new agent and upload a 10-page PDF, then the Knowledge Service should successfully index the document, and the user should be able to ask a question related to the PDF's content and receive a correct answer.  
* Given an agent is configured with a custom tool via the UI, when the user's prompt is intended to trigger that tool, then the Orchestration service must securely call the external API defined by the tool, and the agent's final response must incorporate the result from that API call.  
* Given the .NET Aspire AppHost is started, all defined microservices and containerized databases (Neo4j, Qdrant) must launch successfully, and the developer must be able to view correlated logs and traces for a single request across multiple services in the Aspire dashboard.

## **Language**

C\#

## **Language Version**

.NET v9.0

\[x\] Include global.json? sdk: "9.0.0" rollForward: "latestFeature"

## **Frameworks, Tools, Packages**

* **Service Orchestration:** **.NET Aspire**, chosen to simplify the complexity of developing and debugging a distributed microservices application, providing a unified dashboard for logs, traces, and service discovery out-of-the-box.  
* **Backend Services:** **ASP.NET Core**, for building high-performance, cross-platform web APIs.  
* **Frontend Portal:** **Blazor WebAssembly**, for creating a rich, interactive, client-side web UI with .NET.  
* **AI Orchestration:** **Microsoft.SemanticKernel**, selected as the core AI SDK due to its robust support for planners, prompt templating, and its extensible model for defining and connecting plugins (tools).  
* **Graph Database:** **Neo4j**, chosen for its unparalleled ability to model and query the complex relationships required by both the GraphRAG knowledge graphs and the Mem0 memory graphs.  
* **Vector Database:** **Qdrant**, selected for its high-performance, scalable vector similarity search capabilities, which are essential for the retrieval phase of all RAG-based services.  
* **Real-time Communication:** **Server-Sent Events (SSE)**, chosen for streaming agent responses to the client, which significantly improves the perceived performance and user experience.  
* **API Specification:** **Swashbuckle**, for automatically generating Swagger/OpenAPI documentation from the ASP.NET Core controllers.

## **Project Structure/Package System**

A microservices project structure designed specifically for orchestration with **.NET Aspire**.

/src  
  /AspireAaaS.AppHost        \# The .NET Aspire entry point. Defines the service graph, wiring together all services, databases, and the frontend for local development.  
  /AspireAaaS.ServiceDefaults \# A shared project providing common configurations for all services, such as OpenTelemetry setup, health checks, and resilience policies.  
  /Services  
    /AaaS.Orchestration     \# Main MCP Service, routes requests to other services.  
    /AaaS.Knowledge         \# GraphRAG implementation service.  
    /AaaS.Memory            \# Mem0 implementation service.  
    /AaaS.Verification      \# Grounding RAG implementation service.  
    /AaaS.Tooling           \# Secure tool execution sandbox service.  
  /Web  
    /AaaS.WebApp            \# The Blazor WebAssembly UI project.  
  /Shared  
    /AaaS.Shared.Models     \# A class library containing Data Transfer Objects (DTOs) and API contracts to ensure type safety in inter-service communication.  
/docker-compose.yml           \# For production environment definition and deployment.

## **GitHub**

### **Repo**

[https://github.com/nam20485/](https://github.com/nam20485/agent-asa-service)

### **Branch**

copilot/create-dotnet-app

## **Deliverables**

1. A .NET Aspire solution containing all backend microservices and the frontend web application, fully configured for local debugging and containing launch profiles for each service.  
2. A fully functional Blazor WebAssembly management portal that implements the complete user journey from registration to agent creation, knowledge management, tool definition, and interaction.  
3. Comprehensive API documentation (Swagger/OpenAPI) automatically generated via Swashbuckle and accessible on each service, detailing all public endpoints, models, and authentication requirements.  
4. A suite of unit and integration tests covering critical business logic in each service, with integration tests validating the communication contracts and resilience policies between services.  
5. Configuration files (e.g., docker-compose.yml, Kubernetes manifests) and deployment scripts to facilitate the deployment of the containerized application to a target cloud provider like Azure Kubernetes Service or AWS EKS.